{% extends 'base.html' %}
{% load static %}

{% block title %}Designation List{% endblock %}

{% block content %}
<div class="pagetitle">
  <h1>Designation List</h1>
  <nav>
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#">Home</a></li>
      <li class="breadcrumb-item">Master</li>
      <li class="breadcrumb-item active">Designation</li>
    </ol>
  </nav>
</div>

<section class="section">
  <div class="row">
    <div class="col-lg-12">
      <div class="card border border-primary">
        <div class="card-body">
          <div class="card-title d-lg-flex">
            <h5 class="card-heading my-auto">List of Designations</h5>
            <div class="ms-auto my-auto mt-lg-0 mt-3">
              <a href="{% url 'designation_add' %}" class="btn btn-success">
                <i class="bi bi-plus-circle me-1"></i> Add Designation
              </a>
            </div>
          </div>

          <table
                  class="display responsive dataTable no-footer dtr-inline collapsed"
                  style="width: 100%"
                  id="myTable"
                >
            <thead>
              <tr>
                <th>Sl.No</th>
                <th>Actions</th>
                {% comment %} <th>Designation ID</th> {% endcomment %}
                <th>Designation Name</th>
                <th>Designation Description</th>
                <th>Department</th>
              </tr>
            </thead>
            <tbody>
              {% for des in designations %}
             
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>
                  <div class="d-flex">
                    <!-- Edit -->
                    <a href="{% url 'designation_edit' des.designation_id %}" class="btn btn-outline-info me-1" title="Edit">
                      <i class="bi bi-pencil-fill"></i>
                    </a>

                    <!-- View -->
                    <a href="{% url 'designation_detail' des.designation_id %}" class="btn btn-outline-success me-1" title="View">
                      <i class="bi bi-eye-fill"></i>
                    </a>

                    <!-- Delete -->
                    <button type="button"
                            class="btn btn-outline-danger"
                            title="Delete"
                            data-bs-toggle="modal"
                            data-bs-target="#deleteModal{{ des.designation_id }}">
                      <i class="bi bi-trash-fill"></i>
                    </button>
                  </div>

                  <!-- Delete Confirmation Modal -->
                  <div class="modal fade"
                       id="deleteModal{{ des.designation_id }}"
                       tabindex="-1"
                       aria-labelledby="deleteLabel{{ des.designation_id }}"
                       aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                      <div class="modal-content">
                        <div class="modal-header bg-danger text-white">
                          <h5 class="modal-title" id="deleteLabel{{ des.designation_id }}">
                            Delete Designation
                          </h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          Are you sure you want to delete <strong>{{ des.designation_name }}</strong>?
                          <br><small class="text-muted">This action cannot be undone.</small>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                          <form method="POST" action="{% url 'designation_delete' des.designation_id %}">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-danger">Confirm Delete</button>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </td>

                {% comment %} <td>{{ des.designation_id }}</td> {% endcomment %}
                <td>{{ des.designation_name }}</td>
                <td>{{ des.designation_description }}</td>
                <td>{{ des.department_name }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="6" class="text-center text-muted">No Designations Found</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'assets/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'assets/js/dataTables.responsive.min.js' %}"></script>
<script>
  $(document).ready(function() {
    $('#myTable').DataTable({
      responsive: true,
      pageLength: 10
    });
  });
</script>
{% endblock %}
